<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prueba Acceso Cocina</title>
</head>
<body>
    <h1>ğŸ”§ Prueba de Acceso a Cocina</h1>
    <div id="results"></div>

    <script>
        async function testCocinaAccess() {
            const results = document.getElementById('results');

            // 1. Verificar si hay datos en sessionStorage
            results.innerHTML += '<h2>1ï¸âƒ£ Verificando SessionStorage...</h2>';
            const userData = sessionStorage.getItem('userData');
            const token = sessionStorage.getItem('accessToken');

            results.innerHTML += `<p>userData: ${userData ? 'âœ… Encontrado' : 'âŒ No encontrado'}</p>`;
            results.innerHTML += `<p>accessToken: ${token ? 'âœ… Encontrado' : 'âŒ No encontrado'}</p>`;

            if (userData) {
                const user = JSON.parse(userData);
                results.innerHTML += `<p>Usuario: ${user.usuario}</p>`;
                results.innerHTML += `<p>Rol: ${user.rol}</p>`;

                if (user.rol === 'cocina') {
                    results.innerHTML += '<h2>2ï¸âƒ£ Probando acceso a /cocina...</h2>';

                    // Simular navegaciÃ³n a /cocina
                    results.innerHTML += '<p>ğŸ”„ Intentando acceder a http://localhost:5173/cocina...</p>';
                    results.innerHTML += '<p>âœ… Si el usuario tiene rol cocina, deberÃ­a ver el panel de cocina</p>';
                    results.innerHTML += '<p>âœ… Si no, deberÃ­a ser redirigido a login</p>';

                    // Simular redirecciÃ³n
                    if (user.rol === 'cocina') {
                        results.innerHTML += '<h3 style="color: green;">âœ… Usuario cocina detectado correctamente</h3>';
                        results.innerHTML += '<p>ğŸ”„ Redirigiendo a cocina...</p>';
                        results.innerHTML += '<button onclick="window.open(\'http://localhost:5173/cocina\', \'_blank\')">Abrir Cocina</button>';
                    } else {
                        results.innerHTML += '<h3 style="color: red;">âŒ Usuario no tiene rol cocina</h3>';
                    }
                } else {
                    results.innerHTML += '<h2 style="color: red;">âŒ Usuario no tiene rol cocina</h2>';
                }
            } else {
                results.innerHTML += '<h2 style="color: red;">âŒ No hay datos de usuario en sessionStorage</h2>';
                results.innerHTML += '<p>ğŸ’¡ Necesitas hacer login primero en http://localhost:5173/login</p>';
                results.innerHTML += '<button onclick="window.open(\'http://localhost:5173/login\', \'_blank\')">Ir a Login</button>';
            }
        }

        // Ejecutar la prueba cuando se cargue la pÃ¡gina
        document.addEventListener('DOMContentLoaded', testCocinaAccess);
    </script>
</body>
</html>
