<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prueba Acceso Cocina</title>
</head>
<body>
    <h1>🔧 Prueba de Acceso a Cocina</h1>
    <div id="results"></div>

    <script>
        async function testCocinaAccess() {
            const results = document.getElementById('results');

            // 1. Verificar si hay datos en sessionStorage
            results.innerHTML += '<h2>1️⃣ Verificando SessionStorage...</h2>';
            const userData = sessionStorage.getItem('userData');
            const token = sessionStorage.getItem('accessToken');

            results.innerHTML += `<p>userData: ${userData ? '✅ Encontrado' : '❌ No encontrado'}</p>`;
            results.innerHTML += `<p>accessToken: ${token ? '✅ Encontrado' : '❌ No encontrado'}</p>`;

            if (userData) {
                const user = JSON.parse(userData);
                results.innerHTML += `<p>Usuario: ${user.usuario}</p>`;
                results.innerHTML += `<p>Rol: ${user.rol}</p>`;

                if (user.rol === 'cocina') {
                    results.innerHTML += '<h2>2️⃣ Probando acceso a /cocina...</h2>';

                    // Simular navegación a /cocina
                    results.innerHTML += '<p>🔄 Intentando acceder a http://localhost:5173/cocina...</p>';
                    results.innerHTML += '<p>✅ Si el usuario tiene rol cocina, debería ver el panel de cocina</p>';
                    results.innerHTML += '<p>✅ Si no, debería ser redirigido a login</p>';

                    // Simular redirección
                    if (user.rol === 'cocina') {
                        results.innerHTML += '<h3 style="color: green;">✅ Usuario cocina detectado correctamente</h3>';
                        results.innerHTML += '<p>🔄 Redirigiendo a cocina...</p>';
                        results.innerHTML += '<button onclick="window.open(\'http://localhost:5173/cocina\', \'_blank\')">Abrir Cocina</button>';
                    } else {
                        results.innerHTML += '<h3 style="color: red;">❌ Usuario no tiene rol cocina</h3>';
                    }
                } else {
                    results.innerHTML += '<h2 style="color: red;">❌ Usuario no tiene rol cocina</h2>';
                }
            } else {
                results.innerHTML += '<h2 style="color: red;">❌ No hay datos de usuario en sessionStorage</h2>';
                results.innerHTML += '<p>💡 Necesitas hacer login primero en http://localhost:5173/login</p>';
                results.innerHTML += '<button onclick="window.open(\'http://localhost:5173/login\', \'_blank\')">Ir a Login</button>';
            }
        }

        // Ejecutar la prueba cuando se cargue la página
        document.addEventListener('DOMContentLoaded', testCocinaAccess);
    </script>
</body>
</html>
